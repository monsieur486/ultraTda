<!DOCTYPE HTML>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>TDa Réunion</title>
    <div th:replace="~{fragments/header :: header-css}"></div>
    <link href="" rel="stylesheet"
          th:href="@{/css/reunion.css}"/>
</head>
<body>
<div th:replace="~{fragments/menu :: menu}"></div>
<div class="container-fluid">
        <div id="top-offset"></div>
    <div id="reunion-creation" th:if="${etape == 1}">
        <div class="alert alert-danger" th:if="${creationError}" th:text="${creationError}"></div>
        <div class="alert alert-success" th:if="${creationSuccess}" th:text="${creationSuccess}"></div>

        <form id="reunionCreationForm" method="post" th:action="@{/admin/reunion/creation}">
            <div class="amis-list">
                <div class="ami-item" th:each="ami : ${amis}">
                    <label>
                        <input class="ami-checkbox" name="amiIds" th:value="${ami.id}" type="checkbox">
                        <span th:text="${ami.nom}"></span>
                    </label>
                </div>
            </div>

            <div id="selectionInfo" style="margin-top: 10px;"></div>

            <button class="btn btn-primary" disabled id="btnEnvoyer" type="submit">Envoyer</button>
        </form>

        <script>
            (function () {
                const min = 4;
                const max = 6;

                const form = document.getElementById('reunionCreationForm');
                const btn = document.getElementById('btnEnvoyer');
                const info = document.getElementById('selectionInfo');

                function refresh() {
                    const checked = form.querySelectorAll('.ami-checkbox:checked').length;

                    if (checked < min) {
                        info.textContent = `Sélection: ${checked} (minimum ${min})`;
                        btn.disabled = true;
                    } else if (checked > max) {
                        info.textContent = `Sélection: ${checked} (maximum ${max})`;
                        btn.disabled = true;
                    } else {
                        info.textContent = `Sélection: ${checked} (ok)`;
                        btn.disabled = false;
                    }
                }

                form.addEventListener('change', refresh);
                refresh();
            })();
        </script>
    </div>
    <div id="reunion-encours" th:if="${etape > 1}">
        <p>En cours</p>
    </div>
</div>
<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>